<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>Skyler&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="No pains, No gains!">
<meta property="og:type" content="website">
<meta property="og:title" content="Skyler&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Skyler&#39;s Blog">
<meta property="og:description" content="No pains, No gains!">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Skyler&#39;s Blog">
<meta name="twitter:description" content="No pains, No gains!">
  
    <link rel="alternative" href="/atom.xml" title="Skyler&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="//favicon.ico">
  
  <script src="/style.js"></script>
</head>

<body>
  <div id="container">
    <div class="left-col">
      <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img src="http://7xpdkx.com1.z0.glb.clouddn.com/img/icon/wolf_300.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Skyler Hu</a></h1>
		</hgroup>

		
		<p class="header-subtitle">No pains, No gains!</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">主页</a></li>
	        
				<li><a href="/archives">所有文章</a></li>
	        
				<li><a href="/links">链接们</a></li>
	        
				<li><a href="/about">关于</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
	        
    		
    			
    			<a class="js-smart-menu" data-idx="0" href="javascript:void(0)">所有文章</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="1" href="javascript:void(0)">标签</a>
    			
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/SkylerHu" title="github">github</a>
		        
					<a class="facebook" target="_blank" href="https://www.facebook.com/skyler.hulp" title="facebook">facebook</a>
		        
					<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"><i class="icon-list"></i></div>
  		<h1 class="header-author js-mobile-header hide">Skyler Hu</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				
					<img src="http://7xpdkx.com1.z0.glb.clouddn.com/img/icon/wolf_300.png" class="js-avatar">
				
			</div>
			<hgroup>
			  <h1 class="header-author">Skyler Hu</h1>
			</hgroup>
			
			<p class="header-subtitle">No pains, No gains!</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/links">链接们</a></li>
		        
					<li><a href="/about">关于</a></li>
		        
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/SkylerHu" title="github">github</a>
			        
						<a class="facebook" target="_blank" href="https://www.facebook.com/skyler.hulp" title="facebook">facebook</a>
			        
						<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
        
  
    <article id="post-linux-shell-awk" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/linux-shell-awk/">Linux命令awk</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="一、简介"><a href="#一、简介" class="headerlink" title="一、简介"></a>一、简介</h3><p>awk是一种编程语言，用于在linux/unix下对文本和数据进行处理。数据可以来自标准输入、一个或多个文件，或其它命令的输出。它支持用户自定义函数和动态正则表达式等先进功能，是linux/unix下的一个强大编程工具。它在命令行中使用，但更多是作为脚本来使用。</p>
<p>awk的处理文本和数据的方式：它逐行扫描文件，从第一行到最后一行，寻找匹配的特定模式的行，并在这些行上进行你想要的操作。如果没有指定处理动作，则把匹配的行显示到标准输出(屏幕)，如果没有指定模式，则所有被操作所指定的行都被处理。</p>
<p>awk分别代表其作者姓氏的第一个字母。因为它的作者是三个人，分别是Alfred Aho、Brian Kernighan、Peter Weinberger。</p>
<p>gawk是awk的GNU版本，它提供了Bell实验室和GNU的一些扩展。下面介绍的awk是以GUN的gawk为例的，在linux系统中已把awk链接到gawk，所以下面全部以awk进行介绍。</p>
<h3 id="二、使用"><a href="#二、使用" class="headerlink" title="二、使用"></a>二、使用</h3><p><code>awk [-F  field-separator]  &#39;commands&#39;  input-file(s)</code><br>其中，[-F域分隔符]是可选的，commands 是真正awk命令。 input-file(s) 是待处理的文件。<br>在awk中，文件的每一行中，由域分隔符分开的每一项称为一个域。通常，在不指名-F域分隔符的情况下，默认的域分隔符是空格。</p>
<h3 id="三、模式"><a href="#三、模式" class="headerlink" title="三、模式"></a>三、模式</h3><ol>
<li>正则表达式：使用通配符的扩展集。</li>
<li>关系表达式：可以用下面运算符表中的关系运算符进行操作</li>
<li>可以是字符串或数字的比较，如$2&gt;%1选择第二个字段比第一个字段长的行。</li>
<li>模式匹配表达式：用运算符~(匹配)和~!(不匹配)。</li>
<li>模式，模式：指定一个行的范围。该语法不能包括BEGIN和END模式。</li>
<li>BEGIN：让用户指定在第一条输入记录被处理之前所发生的动作，通常可在这里设置全局变量。</li>
<li>END：让用户在最后一条输入记录被读取之后发生的动作。</li>
</ol>
<h3 id="四、常量"><a href="#四、常量" class="headerlink" title="四、常量"></a>四、常量</h3><table>
<thead>
<tr>
<th>常量名</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>$n</td>
<td>当前记录的第n个字段，字段间由FS分隔</td>
</tr>
<tr>
<td>$0</td>
<td>完整的输入记录</td>
</tr>
<tr>
<td>NF</td>
<td>浏览记录的域的个数</td>
</tr>
<tr>
<td>NR</td>
<td>已读的记录数</td>
</tr>
<tr>
<td>ARGC</td>
<td>命令行参数个数</td>
</tr>
<tr>
<td>ARGV</td>
<td>命令行参数排列</td>
</tr>
<tr>
<td>ENVIRON</td>
<td>支持队列中系统环境变量的使用</td>
</tr>
<tr>
<td>FILENAME</td>
<td>awk浏览的文件名</td>
</tr>
<tr>
<td>FNR</td>
<td>浏览文件的记录数</td>
</tr>
<tr>
<td>FS</td>
<td>设置输入域分隔符，等价于命令行 -F选项</td>
</tr>
<tr>
<td>OFS</td>
<td>输出域分隔符</td>
</tr>
<tr>
<td>ORS</td>
<td>输出记录分隔符</td>
</tr>
<tr>
<td>RS</td>
<td>控制记录分隔符</td>
</tr>
</tbody>
</table>
<h3 id="五、常用函数"><a href="#五、常用函数" class="headerlink" title="五、常用函数"></a>五、常用函数</h3><h6 id="1-求和"><a href="#1-求和" class="headerlink" title="1. 求和"></a>1. 求和</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cat data | awk &apos;&#123;sum+=$1&#125; END &#123;print &quot;Sum = &quot;, sum&#125;&apos;</div></pre></td></tr></table></figure>
<h6 id="2-求平均"><a href="#2-求平均" class="headerlink" title="2. 求平均"></a>2. 求平均</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cat data | awk &apos;&#123;sum+=$1&#125; END &#123;print &quot;Average = &quot;, sum/NR&#125;&apos;</div></pre></td></tr></table></figure>
<h6 id="3-求最大值"><a href="#3-求最大值" class="headerlink" title="3. 求最大值"></a>3. 求最大值</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cat data | awk &apos;BEGIN &#123;max = 0&#125; &#123;if ($1&gt;max) max=$1 fi&#125; END &#123;print &quot;Max=&quot;, max&#125;&apos;</div></pre></td></tr></table></figure>
<h6 id="4-求最小值（min的初始值设置一个超大数即可）"><a href="#4-求最小值（min的初始值设置一个超大数即可）" class="headerlink" title="4. 求最小值（min的初始值设置一个超大数即可）"></a>4. 求最小值（min的初始值设置一个超大数即可）</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cat data | awk &apos;BEGIN &#123;min = 1999999&#125; &#123;if ($1&lt;min) min=$1 fi&#125; END &#123;print &quot;Min=&quot;, min&#125;&apos;</div></pre></td></tr></table></figure>
<h6 id="5-去重"><a href="#5-去重" class="headerlink" title="5. 去重"></a>5. 去重</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">awk -F&apos;:&apos; &apos;!a[$1]++&apos;</div></pre></td></tr></table></figure>
<h6 id="6-输入统计结果"><a href="#6-输入统计结果" class="headerlink" title="6. 输入统计结果"></a>6. 输入统计结果</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cat data | awk &apos;info[$0]=++a[$12] &#123;&#125; END &#123;print &quot;TotalCount = &quot;, NR; for(i in info)&#123;print i, info[i]&#125; &#125;&apos;</div></pre></td></tr></table></figure>
<p>还可以结合 <code>grep</code>/<code>uniq</code>(去重)/<code>sort</code>(排序)等命令一起使用</p>
<h5 id="六、Demo"><a href="#六、Demo" class="headerlink" title="六、Demo"></a>六、Demo</h5><p>当前目录下有三个log文件如下<br>log1.txt<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">2016-11-29 17:10:41,967 GET /api/web/conversation skyler</div><div class="line">2016-11-29 17:10:41,967 GET /api/web/conversation hu</div><div class="line">2016-11-29 17:10:41,967 GET /api/web/conversation hu</div><div class="line">2016-11-29 17:12:12,434 GET /api/web/tag -</div></pre></td></tr></table></figure></p>
<p>log2.txt<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">2016-11-29 17:08:19,794 GET /api/web/account/user huleping</div><div class="line">2016-11-29 17:10:41,967 GET /api/web/conversation skyler</div><div class="line">2016-11-29 17:08:19,794 GET /api/web/account/user skyler</div></pre></td></tr></table></figure></p>
<p>log3.txt<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">2016-11-29 17:12:23,462 GET /api/web/conversation skyler</div><div class="line">2016-11-29 17:12:30,459 GET /api/web/activity huleping</div><div class="line">2016-11-29 17:12:30,474 GET /api/web/conversation huleping</div></pre></td></tr></table></figure></p>
<p>查找出匹配结果相同的结果，然后根据用户id去重统计个数，并输出总数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">➜ for i in $(seq 1 3); do grep &quot;/api/web/conversation&quot; log$&#123;i&#125;.txt; done | awk &apos;!a[$5]++ END &#123;print &quot;TotalCount = &quot;, NR; for(i in a)&#123;print i, a[i] | &quot;sort -r -n -k2&quot;;&#125; &#125;&apos;</div><div class="line">2016-11-29 17:10:41,967 GET /api/web/conversation skyler</div><div class="line">2016-11-29 17:10:41,967 GET /api/web/conversation hu</div><div class="line">2016-11-29 17:12:30,474 GET /api/web/conversation huleping</div><div class="line">TotalCount =  6</div><div class="line">skyler 3</div><div class="line">hu 2</div><div class="line">huleping 1</div></pre></td></tr></table></figure></p>
<hr>
<p><em><code>seq</code> 用于产生从某个数到另外一个数之间的所有整数</em><br><em><a href="http://man.linuxde.net/sort" target="_blank" rel="external">sort用法说明</a></em><br><em>n是按照数字大小排序，-r是以相反顺序，-k是指定需要爱排序的栏位，-t指定栏位分隔符为冒号</em></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/linux-shell-awk/" class="archive-article-date">
  	<time datetime="2017-01-10T12:36:33.000Z" itemprop="datePublished"><i class="icon-clock"></i>2017-01-10</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Shell/">Shell</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-as-show-project-libs-info" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/as-show-project-libs-info/">Android Studio查看项目所有依赖的lib</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>添加task<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">dependencies &#123;</div><div class="line">    ...</div><div class="line">&#125;</div><div class="line">//显示所有依赖包的存储路径以及版本</div><div class="line">task showLibInfo &lt;&lt; &#123;</div><div class="line">    configurations.compile.each &#123; println it &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>然后在项目目录下执行task<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./gradlew showLibInfo</div></pre></td></tr></table></figure></p>
<p>输出结果就可以看到项目所有依赖的lib信息了</p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/as-show-project-libs-info/" class="archive-article-date">
  	<time datetime="2016-12-29T11:26:38.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-12-29</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-python-clear-pyc" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/python-clear-pyc/">清除项目所有pyc文件</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>清除python项目所有pyc文件<br>用python去写一个项目，难免有时候需要处理清除pyc文件，于是写了个脚本，</p>
</blockquote>
<p>可以传入一个文件夹参数，表示需要清理的文件夹<br>默认取当前执行的文件夹路径</p>
<p>脚本具体如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># coding=utf-8</span></div><div class="line"><span class="comment"># Date:2011-03-26</span></div><div class="line"></div><div class="line">import os</div><div class="line">import fnmatch</div><div class="line">import sys</div><div class="line"></div><div class="line"></div><div class="line">def clearpyc(root, patterns=<span class="string">'*'</span>, single_level=False, yield_folders=False):</div><div class="line">    <span class="string">""</span><span class="string">"</span></div><div class="line">    root: 需要遍历的目录</div><div class="line">    patterns： 需要查找的文件，以；为分割的字符串</div><div class="line">    single_level: 是否只遍历单层目录，默认为否</div><div class="line">    yield_folders: 是否包含目录本身，默认为否</div><div class="line">    "<span class="string">""</span></div><div class="line">    patterns = patterns.split(<span class="string">';'</span>)</div><div class="line">    <span class="keyword">for</span> path, subdirs, files <span class="keyword">in</span> os.walk(root):</div><div class="line">        <span class="keyword">if</span> yield_folders:</div><div class="line">            files.extend(subdirs)</div><div class="line">            files.sort()</div><div class="line">        <span class="keyword">for</span> name <span class="keyword">in</span> files:</div><div class="line">            <span class="keyword">for</span> pattern <span class="keyword">in</span> patterns:</div><div class="line">                <span class="keyword">if</span> fnmatch.fnmatch(name, pattern.strip()):  <span class="comment"># 去除pattern两端的空格</span></div><div class="line">                    yield os.path.join(path, name)</div><div class="line">        <span class="keyword">if</span> single_level:</div><div class="line">            <span class="built_in">break</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    <span class="keyword">if</span> 2 == len(sys.argv):</div><div class="line">        directory = os.path.join(os.getcwd(), sys.argv[1])</div><div class="line">        <span class="built_in">print</span>(<span class="string">"参数检查正确"</span>)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        directory = os.getcwd()</div><div class="line">        <span class="built_in">print</span>(<span class="string">"取当前目录"</span>)</div><div class="line"></div><div class="line">    <span class="built_in">print</span>(directory)</div><div class="line"></div><div class="line">    <span class="keyword">for</span> path <span class="keyword">in</span> clearpyc(directory, <span class="string">'*.pyc'</span>):</div><div class="line">        <span class="built_in">print</span>(path)</div><div class="line">        os.remove(path)</div></pre></td></tr></table></figure></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/python-clear-pyc/" class="archive-article-date">
  	<time datetime="2016-12-26T06:39:00.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-12-26</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-terminal-set-shadowsocks" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/terminal-set-shadowsocks/">为终端Terminal设置Shadowsocks代理</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Shadowsocks是我们常用的代理工具，它使用socks5协议，而终端很多工具目前只支持http和https等协议，对socks5协议支持不够好，所以我们为终端设置shadowsocks的思路就是将socks协议转换成http协议，然后为终端设置即可。仔细想想也算是适配器模式的一种现实应用吧。</p>
<p>想要进行转换，需要借助工具，这里我们采用比较知名的polipo来实现。polipo是一个轻量级的缓存web代理程序。闲话休叙，让我们开始动手吧。</p>
<p><a href="http://pages.skylerhu.com/Shadowsocks-SwitchySharp/" target="_blank" rel="external">Shadowsocks的安装与使用</a>参考链接，点击访问</p>
<p>以下我是在Mac上配置的方式，其他系统可模仿。</p>
<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install polipo  <span class="comment"># brew没安装的同学自行安装</span></div></pre></td></tr></table></figure>
<h4 id="修改配置"><a href="#修改配置" class="headerlink" title="修改配置"></a>修改配置</h4><p>设置每次登陆启动polipo<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ln -sfv /usr/<span class="built_in">local</span>/opt/polipo/*.plist ~/Library/LaunchAgents</div></pre></td></tr></table></figure></p>
<p>修改文件<code>/usr/local/opt/polipo/homebrew.mxcl.polipo.plist</code>设置parentProxy<br>增加了 <code>&lt;string&gt;socksParentProxy=localhost:1080&lt;/string&gt;</code><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="meta">&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">plist</span> <span class="attr">version</span>=<span class="string">"1.0"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">dict</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>Label<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>homebrew.mxcl.polipo<span class="tag">&lt;/<span class="name">string</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>RunAtLoad<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">true</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>KeepAlive<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">true</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>ProgramArguments<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">array</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>/usr/local/opt/polipo/bin/polipo<span class="tag">&lt;/<span class="name">string</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>socksParentProxy=localhost:1080<span class="tag">&lt;/<span class="name">string</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">array</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- Set `ulimit -n 20480`. The default OS X limit is 256, that's</span></div><div class="line">         not enough for Polipo (displays 'too many files open' errors).</div><div class="line">         It seems like you have no reason to lower this limit</div><div class="line">         (and unlikely will want to raise it). --&gt;</div><div class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>SoftResourceLimits<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">dict</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">key</span>&gt;</span>NumberOfFiles<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">integer</span>&gt;</span>20480<span class="tag">&lt;/<span class="name">integer</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">plist</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h4 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">launchctl unload ~/Library/LaunchAgents/homebrew.mxcl.polipo.plist</div><div class="line">launchctl load ~/Library/LaunchAgents/homebrew.mxcl.polipo.plis</div></pre></td></tr></table></figure>
<h4 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h4><p>两个语句执行的结果，显示ip地址不一样<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">curl ip.gs</div><div class="line">http_proxy=http://localhost:8123 curl ip.gs</div></pre></td></tr></table></figure></p>
<h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4><p>编辑<code>~/.bash_profile</code>设置别名, 编辑之后执行<code>source ~/.bash_profile</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">alias use_ss=&quot;export http_proxy=http://localhost:8123 &amp;&amp; export https_proxy=http://localhost:8123&quot;</div></pre></td></tr></table></figure></p>
<p>执行命令<code>use_ss</code>就可以使用了, 根据之下命令执行结果可验证<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">curl ip.gs</div><div class="line">use_ss</div><div class="line">curl ip.gs</div></pre></td></tr></table></figure></p>
<p>本文编写<a href="http://droidyue.com/blog/2016/04/04/set-shadowsocks-proxy-for-terminal/index.html" target="_blank" rel="external">参考</a></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/terminal-set-shadowsocks/" class="archive-article-date">
  	<time datetime="2016-12-16T04:54:36.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-12-16</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Shadowsocks/">Shadowsocks</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-android-badge-view" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/android-badge-view/">Android自定义小红点BadgeView</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>想全局统一个小红点样式，总是改了这个忘了其他的，而且小红点格式各样，总是满足不了自己的需求，所以心血来潮自己自定义View onDraw了一个。</p>
<p>可前往查看<a href="https://github.com/SkylerHu/BadgeView" target="_blank" rel="external">GitHub源码</a>.</p>
<p>效果就是这样….</p>
<p><img src="http://7xpdkx.com1.z0.glb.clouddn.com/gif/blog/BadgeView_preview.gif" alt="BadgeView_preview.gif"></p>
<p>一定要记得在<code>attrs.xml</code> 项目中添加</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">declare-styleable</span> <span class="attr">name</span>=<span class="string">"BadgeView"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"iconSrc"</span> <span class="attr">format</span>=<span class="string">"reference"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"iconWidth"</span> <span class="attr">format</span>=<span class="string">"dimension"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"iconHeight"</span> <span class="attr">format</span>=<span class="string">"dimension"</span>/&gt;</span></div><div class="line">        <span class="comment">&lt;!--若是icon是正方形的,可直接设置这个参数--&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"iconSize"</span> <span class="attr">format</span>=<span class="string">"dimension"</span>/&gt;</span></div><div class="line"></div><div class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"text"</span> <span class="attr">format</span>=<span class="string">"string"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"textSize"</span> <span class="attr">format</span>=<span class="string">"dimension"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"textColor"</span> <span class="attr">format</span>=<span class="string">"color"</span>/&gt;</span></div><div class="line"></div><div class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"badgeNum"</span> <span class="attr">format</span>=<span class="string">"integer"</span>/&gt;</span></div><div class="line">        <span class="comment">&lt;!--是否显示数字, 为false时只显示小红点; 没有数字时,小红点的大小通过badgeSize设置--&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"showNum"</span> <span class="attr">format</span>=<span class="string">"boolean"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"badgeBackgroundColor"</span> <span class="attr">format</span>=<span class="string">"color"</span>/&gt;</span></div><div class="line">        <span class="comment">&lt;!--限制设置小红点的大小不能超过数字显示模式(代码中也做了限制); 显示在文字模式大小的左下角;--&gt;</span></div><div class="line">        <span class="comment">&lt;!-- 不显示数字时, 小红点的大小, 不包括边线--&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"badgeRedSize"</span> <span class="attr">format</span>=<span class="string">"dimension"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"badgeNumSize"</span> <span class="attr">format</span>=<span class="string">"dimension"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"badgeNumColor"</span> <span class="attr">format</span>=<span class="string">"color"</span>/&gt;</span></div><div class="line">        <span class="comment">&lt;!--若小红点有边缘线,加上边缘线--&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"badgeBorderColor"</span> <span class="attr">format</span>=<span class="string">"color"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"badgeBorderWidth"</span> <span class="attr">format</span>=<span class="string">"dimension"</span>/&gt;</span></div><div class="line">        <span class="comment">&lt;!--badge相对于主体右上角的相对位置, 重叠的部分的大小; 可以设置负值--&gt;</span></div><div class="line">        <span class="comment">&lt;!--默认是( badgeHeight/2 ), 正好覆盖一个角--&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"badgeBottom"</span> <span class="attr">format</span>=<span class="string">"dimension"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"badgeLeft"</span> <span class="attr">format</span>=<span class="string">"dimension"</span>/&gt;</span></div><div class="line">        <span class="comment">&lt;!-- 有些设计要求未读前面加"+", (至少我们设计师这么设计) 显示成 +1/+34/+99--&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"badgeNumPre"</span> <span class="attr">format</span>=<span class="string">"string"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">declare-styleable</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></div></pre></td></tr></table></figure>
<h4 id="主要代码如下："><a href="#主要代码如下：" class="headerlink" title="主要代码如下："></a>主要代码如下：</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BadgeView</span> <span class="keyword">extends</span> <span class="title">View</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">////可设置部分 start///////////////////////////////////////////////</span></div><div class="line">    <span class="comment">// 主体部分的设置  icon</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> iconSrc;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> iconWidth;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> iconHeight;</div><div class="line">    <span class="comment">// 没有icon 就是文字描述了; icon的优先级比text高</span></div><div class="line">    <span class="keyword">private</span> String text;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> textColor;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> textSize;</div><div class="line"></div><div class="line">    <span class="comment">// 未读数; 在显示的时候 未读数默认显示形式9/23/99+</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> badgeNum;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> badgeBackgroundColor;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> badgeNumColor;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> badgeNumSize;</div><div class="line">    <span class="comment">// 是否显示数字, 默认显示小红点</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> showNum;</div><div class="line">    <span class="comment">// 不显示数字时, 小红点的大小, 不包括边线</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> badgeRedSize;</div><div class="line">    <span class="comment">// 边线, 有些小红点外边有白边, 若是设置了宽度,则会添加边线; 边线算在Badge整个的大小当中</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> badgeBorderWidth;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> badgeBorderColor;</div><div class="line">    <span class="comment">// 有些设计要求未读前面加"+", (至少我们设计师这么设计) 显示成 +1/+34/+99</span></div><div class="line">    <span class="keyword">private</span> String badgeNumPre;</div><div class="line">    <span class="comment">// badge的左下角 相对于 text/icon 右上角的相对位置,</span></div><div class="line">    <span class="comment">// 默认是( badgeHeight/2 ), 正好覆盖一个角</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> badgeBottom;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> badgeLeft;</div><div class="line">    <span class="comment">// 是否自己设置了</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> hasBadgeBottomAttr;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> hasBadgeLeftAttr;</div><div class="line"></div><div class="line">    <span class="comment">// view设置的padding</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> viewPaddingLeft;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> viewPaddingTop;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> viewPaddingRight;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> viewPaddingBootom;</div><div class="line">    <span class="comment">////可设置部分 end///////////////////////////////////////////////</span></div><div class="line"></div><div class="line">    <span class="comment">// 小红点真实大小 比 文本 的margin(不包括白边)</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> BADGE_TEXT_MARGIN_LEFT = <span class="number">10</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> BADGE_TEXT_MARGIN_TOP = <span class="number">6</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> BADGE_TEXT_MARGIN_RIGHT = <span class="number">10</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> BADGE_TEXT_MARGIN_BOOTOM = <span class="number">6</span>;</div><div class="line"></div><div class="line">    <span class="comment">// 可以设置padding</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> VIEW_PADDING = <span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="comment">////以下是辅助变量///////////////////////////////////////////////</span></div><div class="line">    <span class="comment">// 整个View的真实大小</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> viewHeight;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> viewWidth;</div><div class="line">    <span class="comment">// 内容所占的大小, 内容居中</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> viewMinHeight;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> viewMinWidth;</div><div class="line">    <span class="comment">// 小红点有向右突出部分,为保证主体部分水平居中, 需要设置两边的margin</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> mainMarginHorizontal;</div><div class="line">    <span class="comment">// 小红点有向上突出部分,就算没有未读数,也需要预留出位置, 设置Top即可</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> mainMarginTop;</div><div class="line">    <span class="comment">// 描述文字或者icon的宽高</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> mainWidth;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> mainHeight;</div><div class="line">    <span class="comment">// badge的整体宽高</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> badgeHeight;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> badgeWidth;</div><div class="line">    <span class="comment">// badgeNum/小红点 的真实宽高</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> badgeNumHeight;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> badgeNumWidth;</div><div class="line">    <span class="comment">// icon</span></div><div class="line">    <span class="keyword">private</span> Bitmap iconBitmap;</div><div class="line">    <span class="comment">// 未读数显示的文案; 未读数默认显示形式9/23/99+</span></div><div class="line">    <span class="keyword">private</span> String showUneadText;</div><div class="line"></div><div class="line">    <span class="comment">// 画笔</span></div><div class="line">    <span class="keyword">private</span> Paint contentPaint;</div><div class="line">    <span class="keyword">private</span> TextPaint textPaint;</div><div class="line">    <span class="keyword">private</span> TextPaint badgeNumPaint;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BadgeView</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>(context, <span class="keyword">null</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BadgeView</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context, attrs);</div><div class="line">        init(context, attrs);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BadgeView</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyleAttr)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context, attrs, defStyleAttr);</div><div class="line">        init(context, attrs);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</div><div class="line">        TypedArray array = context.obtainStyledAttributes(attrs, R.styleable.BadgeView);</div><div class="line"></div><div class="line">        iconSrc = array.getResourceId(R.styleable.BadgeView_iconSrc, <span class="number">0</span>);</div><div class="line">        <span class="keyword">float</span> iconSize = array.getDimension(R.styleable.BadgeView_iconSize, dip2px(<span class="number">30</span>));</div><div class="line">        iconWidth = array.getDimension(R.styleable.BadgeView_iconWidth, iconSize);</div><div class="line">        iconHeight = array.getDimension(R.styleable.BadgeView_iconHeight, iconSize);</div><div class="line"></div><div class="line">        text = array.getString(R.styleable.BadgeView_text);</div><div class="line">        <span class="keyword">if</span> (TextUtils.isEmpty(text)) &#123;</div><div class="line">            text = <span class="string">"Hello World"</span>;</div><div class="line">        &#125;</div><div class="line">        textColor = array.getColor(R.styleable.BadgeView_textColor, Color.BLACK);</div><div class="line">        textSize = array.getDimension(R.styleable.BadgeView_textSize, sp2px(<span class="number">16</span>));</div><div class="line"></div><div class="line">        badgeNum = array.getInteger(R.styleable.BadgeView_badgeNum, <span class="number">0</span>);</div><div class="line">        badgeBackgroundColor = array.getColor(R.styleable.BadgeView_badgeBackgroundColor, Color.rgb(<span class="number">0xFF</span>, <span class="number">0x76</span>, <span class="number">0x90</span>));</div><div class="line">        badgeNumColor = array.getColor(R.styleable.BadgeView_badgeNumColor, Color.WHITE);</div><div class="line">        badgeNumSize = array.getDimension(R.styleable.BadgeView_badgeNumSize, sp2px(<span class="number">10</span>));</div><div class="line">        badgeNumSize = array.getDimension(R.styleable.BadgeView_badgeNumSize, sp2px(<span class="number">10</span>));</div><div class="line">        showNum = array.getBoolean(R.styleable.BadgeView_showNum, <span class="keyword">true</span>);</div><div class="line">        badgeRedSize = array.getDimension(R.styleable.BadgeView_badgeRedSize, dip2px(<span class="number">8</span>));</div><div class="line">        badgeBorderColor = array.getColor(R.styleable.BadgeView_badgeBorderColor, Color.WHITE);</div><div class="line">        badgeBorderWidth = array.getDimension(R.styleable.BadgeView_badgeBorderWidth, <span class="number">0</span>);</div><div class="line">        <span class="keyword">if</span> (badgeBorderWidth &lt; <span class="number">0</span>) &#123;</div><div class="line">            badgeBorderWidth = <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">        badgeNumPre = array.getString(R.styleable.BadgeView_badgeNumPre);</div><div class="line"></div><div class="line">        <span class="comment">// 初始化badgeNum的画笔</span></div><div class="line">        badgeNumPaint = <span class="keyword">new</span> TextPaint();</div><div class="line">        badgeNumPaint.setAntiAlias(<span class="keyword">true</span>);</div><div class="line">        badgeNumPaint.setColor(badgeNumColor);</div><div class="line">        badgeNumPaint.setTextSize(badgeNumSize);</div><div class="line">        badgeNumPaint.setTextAlign(Paint.Align.CENTER);</div><div class="line">        <span class="comment">// 计算 未读数的高度</span></div><div class="line">        String minBadge = getUnreadText(<span class="number">0</span>);</div><div class="line">        Rect minBadgeRect = <span class="keyword">new</span> Rect();</div><div class="line">        badgeNumPaint.getTextBounds(minBadge, <span class="number">0</span>, minBadge.length(), minBadgeRect);</div><div class="line">        <span class="comment">// 计算badge的高度</span></div><div class="line">        badgeNumHeight = minBadgeRect.height();</div><div class="line">        badgeHeight = badgeNumHeight + BADGE_TEXT_MARGIN_TOP + BADGE_TEXT_MARGIN_BOOTOM + badgeBorderWidth * <span class="number">2</span>;</div><div class="line">        <span class="comment">// 限制设置小红点的大小不能超过数字显示模式; 显示在文字模式大小的左下角</span></div><div class="line">        <span class="keyword">if</span> (badgeRedSize &gt; badgeNumHeight + BADGE_TEXT_MARGIN_TOP + BADGE_TEXT_MARGIN_BOOTOM) &#123;</div><div class="line">            badgeRedSize = badgeNumHeight + BADGE_TEXT_MARGIN_TOP + BADGE_TEXT_MARGIN_BOOTOM;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// 获取位置</span></div><div class="line">        hasBadgeBottomAttr = array.hasValue(R.styleable.BadgeView_badgeBottom);</div><div class="line">        hasBadgeLeftAttr = array.hasValue(R.styleable.BadgeView_badgeLeft);</div><div class="line">        badgeBottom = array.getDimension(R.styleable.BadgeView_badgeBottom, <span class="number">0</span>);</div><div class="line">        badgeLeft = array.getDimension(R.styleable.BadgeView_badgeLeft,  <span class="number">0</span>);</div><div class="line">        <span class="comment">//关闭清空TypedArray</span></div><div class="line">        array.recycle();</div><div class="line"></div><div class="line">        <span class="comment">// 初始化主体文字描述的画笔</span></div><div class="line">        textPaint = <span class="keyword">new</span> TextPaint();</div><div class="line">        textPaint.setAntiAlias(<span class="keyword">true</span>);</div><div class="line">        textPaint.setColor(textColor);</div><div class="line">        textPaint.setTextSize(textSize);</div><div class="line">        textPaint.setTextAlign(Paint.Align.CENTER);</div><div class="line"></div><div class="line">        contentPaint = <span class="keyword">new</span> Paint();</div><div class="line">        contentPaint.setAntiAlias(<span class="keyword">true</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBadgeNum</span><span class="params">(<span class="keyword">int</span> badgeNum)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.badgeNum = badgeNum;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setShowNum</span><span class="params">(<span class="keyword">boolean</span> isShow)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.showNum = isShow;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setIconSrc</span><span class="params">(<span class="keyword">int</span> res)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.iconSrc = res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBadgeLocation</span><span class="params">(<span class="keyword">float</span> bottom, <span class="keyword">float</span> left)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.badgeBottom = bottom;</div><div class="line">        <span class="keyword">this</span>.badgeLeft = left;</div><div class="line">        hasBadgeBottomAttr = <span class="keyword">true</span>;</div><div class="line">        hasBadgeLeftAttr = <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 重新计算绘制这个View</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">redraw</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="comment">// 需要重新计算高宽,所以用这个</span></div><div class="line">        requestLayout();</div><div class="line"><span class="comment">//        invalidate();</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onDraw(canvas);</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (viewWidth != viewMinWidth || viewHeight != viewMinHeight) &#123;</div><div class="line">            canvas.save();</div><div class="line">            <span class="comment">// 若是设置的高宽大于所需要的高宽, 对画布进行操作</span></div><div class="line">            <span class="keyword">float</span> paddingLeft = viewPaddingLeft + (viewWidth - viewPaddingLeft - viewPaddingRight - viewMinWidth) / <span class="number">2</span>;</div><div class="line">            <span class="keyword">float</span> paddingTop = viewPaddingTop + (viewHeight -viewPaddingTop -viewPaddingBootom - viewMinHeight) / <span class="number">2</span>;</div><div class="line">            <span class="comment">// 移动布局, 改变原点</span></div><div class="line">            canvas.translate(paddingLeft, paddingTop);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        onDrawContent(canvas);</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (viewWidth != viewMinWidth || viewHeight != viewMinHeight) &#123;</div><div class="line">            canvas.restore();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 绘制整个内容</div><div class="line">     * <span class="doctag">@param</span> canvas</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">onDrawContent</span><span class="params">(Canvas canvas)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (iconSrc != <span class="number">0</span>) &#123;</div><div class="line">            <span class="comment">// 画icon</span></div><div class="line">            canvas.drawBitmap(iconBitmap, mainMarginHorizontal + (mainWidth - iconWidth) / <span class="number">2</span>, mainMarginTop + (mainHeight - iconHeight) / <span class="number">2</span>, contentPaint);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="comment">// 写text, 文字是居中的</span></div><div class="line">            canvas.drawText(text, viewMinWidth / <span class="number">2</span>, viewMinHeight, textPaint);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (badgeNum &gt; <span class="number">0</span>) &#123;</div><div class="line">            canvas.save();</div><div class="line">            <span class="comment">// 移动布局, 改变原点</span></div><div class="line">            canvas.translate(viewMinWidth - badgeWidth, <span class="number">0</span>);</div><div class="line"></div><div class="line">            oDrawBadge(canvas);</div><div class="line"></div><div class="line">            canvas.restore();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">oDrawBadge</span><span class="params">(Canvas canvas)</span> </span>&#123;</div><div class="line">        <span class="comment">// 若有小红点有边缘线, 画边缘线</span></div><div class="line">        <span class="keyword">if</span> (badgeBorderWidth &gt; <span class="number">0</span>) &#123;</div><div class="line">            contentPaint.setStyle(Paint.Style.STROKE);</div><div class="line">            contentPaint.setColor(badgeBorderColor);</div><div class="line">            contentPaint.setStrokeWidth(badgeBorderWidth);</div><div class="line">            <span class="keyword">if</span> (!showNum) &#123;</div><div class="line">                <span class="comment">// 不显示数字</span></div><div class="line">                canvas.drawCircle(badgeWidth / <span class="number">2</span>, badgeHeight - badgeRedSize / <span class="number">2</span> - badgeBorderWidth, badgeRedSize / <span class="number">2</span>, contentPaint);</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (badgeWidth == badgeHeight) &#123;</div><div class="line">                <span class="comment">// 显示是字符串长度为1时, 为正圆</span></div><div class="line">                canvas.drawCircle(badgeWidth / <span class="number">2</span>, badgeHeight / <span class="number">2</span>, badgeWidth / <span class="number">2</span>, contentPaint);</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="comment">// 椭圆</span></div><div class="line">                Path borderPath = <span class="keyword">new</span> Path();</div><div class="line">                borderPath.addArc(<span class="keyword">new</span> RectF(<span class="number">0</span>, <span class="number">0</span>, badgeHeight, badgeHeight), <span class="number">90</span>, <span class="number">180</span>);</div><div class="line">                borderPath.lineTo(badgeWidth - badgeHeight / <span class="number">2</span>, <span class="number">0</span>);</div><div class="line">                borderPath.addArc(<span class="keyword">new</span> RectF(badgeWidth - badgeHeight, <span class="number">0</span>, badgeWidth, badgeHeight), <span class="number">270</span>, <span class="number">180</span>);</div><div class="line">                borderPath.lineTo(badgeHeight / <span class="number">2</span>, badgeHeight);</div><div class="line">                canvas.drawPath(borderPath, contentPaint);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        contentPaint.setColor(badgeBackgroundColor);</div><div class="line">        contentPaint.setStyle(Paint.Style.FILL);</div><div class="line">        <span class="keyword">if</span> (showNum) &#123;</div><div class="line">            <span class="comment">// 绘制红色背景图</span></div><div class="line">            Path path = <span class="keyword">new</span> Path();</div><div class="line">            path.addArc(<span class="keyword">new</span> RectF(badgeBorderWidth, badgeBorderWidth, badgeHeight - badgeBorderWidth, badgeHeight - badgeBorderWidth), <span class="number">90</span>, <span class="number">180</span>);</div><div class="line">            path.lineTo(badgeWidth - badgeHeight / <span class="number">2</span> + badgeBorderWidth, badgeBorderWidth);</div><div class="line">            path.addArc(<span class="keyword">new</span> RectF(badgeWidth - badgeHeight + badgeBorderWidth, badgeBorderWidth, badgeWidth - badgeBorderWidth, badgeHeight - badgeBorderWidth), <span class="number">270</span>, <span class="number">180</span>);</div><div class="line">            path.lineTo(badgeHeight / <span class="number">2</span> - badgeBorderWidth, badgeHeight - badgeBorderWidth);</div><div class="line">            canvas.drawPath(path, contentPaint);</div><div class="line">            <span class="comment">// 写上数字</span></div><div class="line">            canvas.drawText(showUneadText, badgeWidth / <span class="number">2</span>, badgeHeight - BADGE_TEXT_MARGIN_BOOTOM - badgeBorderWidth, badgeNumPaint);</div><div class="line"></div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="comment">// 画实心圆</span></div><div class="line">            canvas.drawCircle(badgeRedSize / <span class="number">2</span> + badgeBorderWidth, badgeHeight - badgeRedSize / <span class="number">2</span> - badgeBorderWidth, badgeRedSize / <span class="number">2</span>, contentPaint);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">intParams</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="comment">// 初始化主体的一些数据</span></div><div class="line">        <span class="keyword">if</span> (iconSrc != <span class="number">0</span>) &#123;</div><div class="line">            mainHeight = iconHeight;</div><div class="line">            mainWidth = iconWidth;</div><div class="line">            <span class="keyword">if</span> (iconBitmap == <span class="keyword">null</span>) &#123;</div><div class="line">                Bitmap bitmap = BitmapFactory.decodeResource(getResources(), iconSrc);</div><div class="line">                <span class="comment">// 缩放图片</span></div><div class="line">                <span class="keyword">int</span> width = bitmap.getWidth();</div><div class="line">                <span class="keyword">int</span> height = bitmap.getHeight();</div><div class="line">                <span class="comment">// 保证icon的scaleType="fitCenter"</span></div><div class="line">                <span class="comment">// 获取图片的长边</span></div><div class="line">                <span class="keyword">float</span> length = width &gt; height ? width : height;</div><div class="line">                <span class="comment">// 获取外框的最小边</span></div><div class="line">                <span class="keyword">float</span> size = iconWidth &gt; iconHeight ? iconHeight : iconWidth;</div><div class="line">                <span class="comment">// 让图片按照长边进行缩放</span></div><div class="line">                <span class="keyword">float</span> scale = size / length;</div><div class="line">                Matrix matrix = <span class="keyword">new</span> Matrix();</div><div class="line">                matrix.postScale(scale, scale);</div><div class="line">                iconBitmap = Bitmap.createBitmap(bitmap, <span class="number">0</span>, <span class="number">0</span>, width, height, matrix, <span class="keyword">true</span>);</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// 因为icon是fitCenter, 所以有真实大小</span></div><div class="line">            iconWidth = iconBitmap.getWidth();</div><div class="line">            iconHeight = iconBitmap.getHeight();</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="comment">// 字符描述文字的大小</span></div><div class="line">            Rect descRect = <span class="keyword">new</span> Rect();</div><div class="line">            textPaint.getTextBounds(text, <span class="number">0</span>, text.length(), descRect);</div><div class="line">            mainWidth = descRect.width();</div><div class="line">            mainHeight = descRect.height();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// 初始化Badge的数据</span></div><div class="line">        <span class="keyword">if</span> (showNum) &#123;</div><div class="line">            showUneadText = getUnreadText(badgeNum);</div><div class="line">            Rect badgeRect = <span class="keyword">new</span> Rect();</div><div class="line">            badgeNumPaint.getTextBounds(showUneadText, <span class="number">0</span>, showUneadText.length(), badgeRect);</div><div class="line"></div><div class="line">            badgeNumWidth = badgeRect.width();</div><div class="line"></div><div class="line">            <span class="keyword">if</span> (showUneadText.length() == <span class="number">1</span>) &#123;</div><div class="line">                <span class="comment">// 当长度为1的时候,显示正圆</span></div><div class="line">                badgeWidth = badgeHeight;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                badgeWidth = badgeNumWidth + BADGE_TEXT_MARGIN_LEFT + BADGE_TEXT_MARGIN_RIGHT + badgeBorderWidth * <span class="number">2</span>;</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            badgeWidth = badgeRedSize + badgeBorderWidth * <span class="number">2</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// badgeHeight在构造方法中初始化了, 全部使用数字模式的高度</span></div><div class="line"></div><div class="line">        <span class="comment">// Badge位置设置的范围做一个限制</span></div><div class="line">        <span class="keyword">if</span> (!hasBadgeLeftAttr || badgeLeft &gt; mainWidth) &#123;</div><div class="line">            badgeLeft = getBadgeDefaultLocation();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (!hasBadgeBottomAttr || badgeBottom &gt; mainHeight) &#123;</div><div class="line">            badgeBottom = getBadgeDefaultLocation();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// 计算整体内容的大小</span></div><div class="line">        mainMarginHorizontal = badgeWidth - badgeLeft;</div><div class="line">        mainMarginTop = badgeHeight - badgeBottom;</div><div class="line">        viewMinWidth = mainWidth + mainMarginHorizontal * <span class="number">2</span>;</div><div class="line">        viewMinHeight = mainHeight + mainMarginTop;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 获取默认的位置</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">float</span> <span class="title">getBadgeDefaultLocation</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="comment">// 文字的时候默认往上些, 盖住文字了</span></div><div class="line">        <span class="keyword">return</span> iconSrc != <span class="number">0</span> ? (showNum ? badgeHeight / <span class="number">2</span> : badgeRedSize / <span class="number">2</span> + badgeBorderWidth) : badgeRedSize / <span class="number">2</span> + badgeBorderWidth - <span class="number">3</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 构造未读数显示的文本</div><div class="line">     * 1) 未读数默认显示形式9/23/99+</div><div class="line">     * 2) 有些设计要求未读前面加"+", (至少我们设计师这么设计) 显示成 +1/+34/+99, 取配置badgeNumPre</div><div class="line">     * <span class="doctag">@param</span> unread</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">getUnreadText</span><span class="params">(<span class="keyword">int</span> unread)</span> </span>&#123;</div><div class="line">        String text = String.valueOf(unread);</div><div class="line">        <span class="keyword">if</span> (TextUtils.isEmpty(badgeNumPre)) &#123;</div><div class="line">            <span class="keyword">if</span> (unread &gt; <span class="number">99</span>) &#123;</div><div class="line">                text = <span class="string">"99+"</span>;</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">if</span> (unread &gt; <span class="number">99</span>) &#123;</div><div class="line">                text = badgeNumPre + <span class="string">"99"</span>;</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (unread &gt;= <span class="number">0</span>) &#123;</div><div class="line">                text = badgeNumPre + unread;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> text;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">dip2px</span><span class="params">(<span class="keyword">int</span> dpValue)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> (<span class="keyword">int</span>) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, dpValue, getResources().getDisplayMetrics());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">sp2px</span><span class="params">(<span class="keyword">int</span> spValue)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> (<span class="keyword">int</span>) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_SP, spValue, getResources().getDisplayMetrics());</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * android-自定义View解决wrap_content无效的问题</div><div class="line">     * see  https://my.oschina.net/ccqy66/blog/616662</div><div class="line">     * <span class="doctag">@param</span> widthMeasureSpec</div><div class="line">     * <span class="doctag">@param</span> heightMeasureSpec</div><div class="line">     */</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onMeasure</span><span class="params">(<span class="keyword">int</span> widthMeasureSpec, <span class="keyword">int</span> heightMeasureSpec)</span> </span>&#123;</div><div class="line">        <span class="comment">// 计算高宽</span></div><div class="line">        intParams();</div><div class="line">        viewPaddingLeft = getPaddingLeft();</div><div class="line">        viewPaddingTop = getPaddingTop();</div><div class="line">        viewPaddingRight = getPaddingRight();</div><div class="line">        viewPaddingBootom = getPaddingBottom();</div><div class="line"></div><div class="line">        <span class="keyword">int</span> widthMode = MeasureSpec.getMode(widthMeasureSpec);</div><div class="line">        <span class="keyword">int</span> widthSize = MeasureSpec.getSize(widthMeasureSpec);</div><div class="line">        <span class="keyword">int</span> heightMode = MeasureSpec.getMode(heightMeasureSpec);</div><div class="line">        <span class="keyword">int</span> heightSize = MeasureSpec.getSize(heightMeasureSpec);</div><div class="line"></div><div class="line">        <span class="comment">//Measure Width</span></div><div class="line">        <span class="keyword">if</span> (widthMode == MeasureSpec.EXACTLY) &#123;</div><div class="line">            <span class="comment">// 设置的大小不能比内容还小</span></div><div class="line">            viewWidth = widthSize &lt; viewMinWidth ? viewMinWidth : widthSize;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            viewWidth = viewMinWidth;</div><div class="line">        &#125;</div><div class="line">        viewWidth += viewPaddingLeft + viewPaddingRight;</div><div class="line"></div><div class="line">        <span class="comment">//Measure Height</span></div><div class="line">        <span class="keyword">if</span> (heightMode == MeasureSpec.EXACTLY) &#123;</div><div class="line">            <span class="comment">// 设置的大小不能比内容还小</span></div><div class="line">            viewHeight = heightSize &lt; viewMinHeight ? viewMinHeight : heightSize;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            viewHeight = viewMinHeight;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (viewHeight &lt; viewMinHeight + VIEW_PADDING * <span class="number">2</span>) &#123;</div><div class="line">            viewHeight =  viewMinHeight + VIEW_PADDING * <span class="number">2</span>;</div><div class="line">        &#125;</div><div class="line">        viewHeight += viewPaddingTop + viewPaddingBootom;</div><div class="line"></div><div class="line">        <span class="comment">//MUST CALL THIS</span></div><div class="line">        setMeasuredDimension((<span class="keyword">int</span>) Math.ceil(viewWidth), (<span class="keyword">int</span>) Math.ceil(viewHeight));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/android-badge-view/" class="archive-article-date">
  	<time datetime="2016-12-16T02:59:54.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-12-16</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-fix-git-commit-msg-use-vim-error" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/fix-git-commit-msg-use-vim-error/">Mac修正Vim无法git提交的问题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Git 可以使用Vim作为 Commit Message编辑器，上次不小心出现了以下错误：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">error: There was a problem with the editor &apos;vim&apos;.Please supply the message using either -m or -F option.</div></pre></td></tr></table></figure></p>
<p>如果在 Vim 中编辑文本时因为按键失误出现类似这样：<em>E492: Not an editor command…</em> 的错误信息时，必然无法提交。</p>
<p>后来在 <a href="http://groups.google.com/group/vim_mac/browse_thread/thread/0d33e2f2130867b0" target="_blank" rel="external">Google Group: vim_mac</a> 这个帖子中找到了解决的办法，就是使用完整的 Vim 路径—— /usr/bin/vim :<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git config --global core.editor /usr/bin/vim</div></pre></td></tr></table></figure></p>
<p>看了一些别的博客，说有可能的原因是：<br><code>Vim 在遇到 Exx Error 时返回 Non-Zero code 是为了兼容 Posix，不过这种情况应该只会出现在使用 Ex Mode 时，Normal/Insert Mode 是不会这样的。</code></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/fix-git-commit-msg-use-vim-error/" class="archive-article-date">
  	<time datetime="2016-11-28T07:31:05.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-11-28</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/">git</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-vim-settings" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/vim-settings/">如何优雅的使用Vim</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="我的电脑"><a href="#我的电脑" class="headerlink" title="我的电脑"></a>我的电脑</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">➜  ~  sw_vers</div><div class="line">ProductName:    Mac OS X</div><div class="line">ProductVersion: 10.10.5</div><div class="line">BuildVersion:   14F1021</div><div class="line">➜  ~  python -V</div><div class="line">Python 2.7.10</div></pre></td></tr></table></figure>
<h2 id="配置前的准备"><a href="#配置前的准备" class="headerlink" title="配置前的准备"></a>配置前的准备</h2><p>默认大家是安装了 <a href="http://brew.sh/" target="_blank" rel="external">HomeBrew</a>, 没有的话请自行安装</p>
<p>若是需要安装Python的代码提示 <code>YouCompleteMe</code>, 要求:</p>
<ul>
<li>YouCompleteMe unavailable: requires Vim 7.3.598+</li>
<li>还需要Python支持Python module</li>
</ul>
<p>执行以下命令可以查看相关支持信息(<code>+</code>支持、<code>-</code>不支持)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">➜  ~  vim --version</div><div class="line">VIM - Vi IMproved 7.4 (2013 Aug 10, compiled Apr 28 2016 11:12:36)</div><div class="line">+cryptv          +linebreak       -python          +vreplace</div><div class="line">+cscope          +lispindent      +python3         +wildignore</div></pre></td></tr></table></figure>
<p>若是版本不对 或者 not support python module，请执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">sudo mv /usr/bin/vim /usr/bin/vim_bk  <span class="comment"># 把系统默认的vim备份了</span></div><div class="line">brew install vim --with-python3  <span class="comment"># 安装新的vim</span></div><div class="line"><span class="comment"># 若是下面的步骤执行不下去了，尝试一下 brew install vim --with-python</span></div></pre></td></tr></table></figure>
<ul>
<li>最后还需安装  <code>brew instal CMake</code></li>
</ul>
<h2 id="安装vim-插件"><a href="#安装vim-插件" class="headerlink" title="安装vim 插件"></a>安装vim 插件</h2><p>执行以下脚本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/bin/sh</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> [ ! <span class="_">-d</span> ~/.vim ]; <span class="keyword">then</span></div><div class="line">mkdir ~/.vim</div><div class="line"><span class="keyword">fi</span></div><div class="line"></div><div class="line"><span class="built_in">cd</span> ~/.vim</div><div class="line"></div><div class="line"><span class="keyword">if</span> [ ! <span class="_">-d</span> bundle ]; <span class="keyword">then</span></div><div class="line">mkdir bundle</div><div class="line"><span class="keyword">fi</span></div><div class="line"></div><div class="line"><span class="built_in">cd</span> bundle</div><div class="line">git <span class="built_in">clone</span> https://github.com/VundleVim/Vundle.vim.git   <span class="comment"># 管理工具</span></div><div class="line">git <span class="built_in">clone</span> https://github.com/Lokaltog/vim-powerline.git <span class="comment"># </span></div><div class="line">git <span class="built_in">clone</span> https://github.com/scrooloose/nerdtree.git <span class="comment"># 目录树</span></div><div class="line">git <span class="built_in">clone</span> https://github.com/jistr/vim-nerdtree-tabs.git  <span class="comment"># </span></div><div class="line">git <span class="built_in">clone</span> https://github.com/vim-scripts/taglist.vim.git <span class="comment"># 方法类跳转</span></div><div class="line">git <span class="built_in">clone</span> https://github.com/vim-scripts/AutoTag.git</div><div class="line">git <span class="built_in">clone</span> https://github.com/scrooloose/syntastic.git  <span class="comment"># js语法检测</span></div><div class="line">git <span class="built_in">clone</span> https://github.com/tpope/vim-fugitive.git <span class="comment"># 显示Git信息</span></div><div class="line">git <span class="built_in">clone</span> https://github.com/Valloric/YouCompleteMe.git <span class="comment"># python 自动补全</span></div><div class="line">git <span class="built_in">clone</span> https://github.com/hynek/vim-python-pep8-indent <span class="comment"># pep8 python语法 需要在项目虚拟环境下 pip install pep8</span></div><div class="line">git <span class="built_in">clone</span> https://github.com/nvie/vim-flake8 <span class="comment"># 代码风格检测 需要在项目虚拟环境下 pip install flake8</span></div><div class="line">git <span class="built_in">clone</span> https://github.com/Yggdroot/indentLine  <span class="comment"># 代码格式对齐线</span></div><div class="line"><span class="comment"># git clone https://github.com/vim-ruby/vim-ruby # ruby插件</span></div><div class="line"><span class="built_in">cd</span> YouCompleteMe</div><div class="line">git submodule update --init --recursive</div><div class="line">./install.py  --clang-completer</div><div class="line"></div><div class="line"><span class="built_in">cd</span> ..</div><div class="line">mkdir -p ~/.vim/<span class="built_in">autoload</span> ~/.vim/bundle &amp;&amp; curl -LSso ~/.vim/<span class="built_in">autoload</span>/pathogen.vim https://tpo.pe/pathogen.vim</div><div class="line"><span class="built_in">cd</span> ~</div><div class="line">brew install ctags</div></pre></td></tr></table></figure>
<p>以上所有vim插件都在GitHub上<br>若是要更新哪个插件，直接到插件目录下去git pull 就行了；<br>值得注意的是 最好查看下插件的README，看它的用发是否发生了改变，需要自行更新 .vimrc中的配置</p>
<h2 id="vimrc-配置文件"><a href="#vimrc-配置文件" class="headerlink" title=".vimrc 配置文件"></a>.vimrc 配置文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> ~</div><div class="line">vim .vimrc  <span class="comment"># 编辑 .vimrc 文件 内容如下</span></div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div></pre></td><td class="code"><pre><div class="line">syntax on</div><div class="line">set encoding=utf-8</div><div class="line">&quot; 自动缩进</div><div class="line">set autoindent</div><div class="line">set cindent</div><div class="line">set autoread &quot; 设置当文件被改动时自动载入</div><div class="line">set wildmenu &quot; 增强模式中的命令行自动完成操作</div><div class="line">set showcmd         &quot; 输入的命令显示出来，看的清楚些  </div><div class="line">set whichwrap+=&lt;,&gt;,h,l  &quot; 允许backspace和光标键跨越行边界</div><div class="line">set ruler           &quot; 显示标尺  </div><div class="line">set tabstop=4</div><div class="line">set shiftwidth=4</div><div class="line">set softtabstop=4</div><div class="line">set expandtab</div><div class="line">set nu</div><div class="line">set hlsearch</div><div class="line">set incsearch</div><div class="line">set colorcolumn=120</div><div class="line">set cul &quot;高亮光标所在行</div><div class="line">autocmd InsertEnter * se cul    &quot; 用浅色高亮当前行  </div><div class="line">set scrolloff=3     &quot; 光标移动到buffer的顶部和底部时保持3行距离  </div><div class="line">&quot;set statusline=%&lt;\ %n:%F\ %m%r%y%=%-35.(line:\ %l\ of\ %L,\ col:\ %c%V\ (%P)%)</div><div class="line">set statusline=%F%m%r%h%w\ [FORMAT=%&#123;&amp;ff&#125;]\ [TYPE=%Y]\ [POS=%l,%v][%p%%]\ %&#123;strftime(\&quot;%d/%m/%y\ -\ %H:%M\&quot;)&#125;   &quot;状态行显示的内容  </div><div class="line">set laststatus=2</div><div class="line">set ignorecase</div><div class="line">set backspace=indent,eol,start &quot; backspace over everything in insert mode</div><div class="line">set nocompatible              &quot; be iMproved, required</div><div class="line">filetype off                  &quot; required</div><div class="line"></div><div class="line">set foldnestmax=10      &quot;deepest fold is 10 levels</div><div class="line">set foldlevel=1         &quot;this is just what i use</div><div class="line">set foldmethod=marker</div><div class="line"></div><div class="line">set paste</div><div class="line"></div><div class="line">map &lt;F2&gt; :mksession! ~/.vim_session &lt;cr&gt; &quot; Quick write session with F2</div><div class="line">map &lt;F3&gt; :source ~/.vim_session &lt;cr&gt;     &quot; And load session with F3</div><div class="line"></div><div class="line">execute pathogen#infect()</div><div class="line"></div><div class="line">function! ResCur()</div><div class="line">        if line(&quot;&apos;\&quot;&quot;) &lt;= line(&quot;$&quot;)</div><div class="line">                normal! g`&quot;</div><div class="line">                return 1</div><div class="line">        endif</div><div class="line">endfunction</div><div class="line"></div><div class="line">augroup resCur</div><div class="line">        autocmd!</div><div class="line">        autocmd BufWinEnter * call ResCur()</div><div class="line">augroup END</div><div class="line"></div><div class="line">filetype plugin indent on    &quot; required</div><div class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</div><div class="line">&quot;&quot;&quot;&quot;&quot;新文件标题</div><div class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</div><div class="line">&quot;新建.c,.h,.sh,.java文件，自动插入文件头 </div><div class="line">autocmd BufNewFile *.cpp,*.[ch],*.sh,*.rb,*.java,*.py exec &quot;:call SetTitle()&quot; </div><div class="line">&quot;&quot;定义函数SetTitle，自动插入文件头 </div><div class="line">func SetTitle() </div><div class="line">	&quot;如果文件类型为.sh文件 </div><div class="line">	if &amp;filetype == &apos;sh&apos; </div><div class="line">		call setline(1,&quot;\#!/bin/bash&quot;) </div><div class="line">		call append(line(&quot;.&quot;), &quot;&quot;) </div><div class="line">    elseif &amp;filetype == &apos;python&apos;</div><div class="line">        call setline(1,&quot;#!/usr/bin/env python&quot;)</div><div class="line">        call append(line(&quot;.&quot;),&quot;# coding=utf-8&quot;)</div><div class="line">	    call append(line(&quot;.&quot;)+1, &quot;&quot;) </div><div class="line">	endif</div><div class="line">endfunc </div><div class="line">autocmd BufNewFile * normal G</div><div class="line"></div><div class="line">au BufNewFile,BufRead *.yml set filetype=xml</div><div class="line">autocmd FileType python setlocal completeopt-=preview</div><div class="line"></div><div class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</div><div class="line">&quot;&quot;&quot;&quot; 插件管理</div><div class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</div><div class="line">&quot; set the runtime path to include Vundle and initialize</div><div class="line">set rtp+=~/.vim/Vundle.vim</div><div class="line">call vundle#begin()</div><div class="line">&quot; alternatively, pass a path where Vundle should install plugins</div><div class="line">&quot;call vundle#begin(&apos;~/some/path/here&apos;)</div><div class="line"></div><div class="line">&quot; let Vundle manage Vundle, required</div><div class="line">Plugin &apos;gmarik/Vundle.vim&apos;</div><div class="line">&quot; All of your Plugins must be added before the following line</div><div class="line">call vundle#end()            &quot; required</div><div class="line"></div><div class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</div><div class="line">&quot;Yggdroot/indentLine</div><div class="line">let g:indentLine_char = &apos;┊&apos;</div><div class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</div><div class="line">&quot;powerline&#123;</div><div class="line">set guifont=PowerlineSymbols\ for\ Powerline</div><div class="line">set nocompatible</div><div class="line">set t_Co=256</div><div class="line">let g:Powerline_stl_path_style = &quot;full&quot;</div><div class="line">&quot;&#125;</div><div class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</div><div class="line">&quot;打开文件类型检测, 加了这句才可以用智能补全</div><div class="line">set completeopt=preview,menu </div><div class="line">set completeopt=longest,menu</div><div class="line">&quot;python补全</div><div class="line">let g:pydiction_location = &apos;~/.vim/after/complete-dict&apos;</div><div class="line">let g:pydiction_menu_height = 20</div><div class="line">let g:miniBufExplMapWindowNavVim = 1</div><div class="line">let g:miniBufExplMapWindowNavArrows = 1</div><div class="line">let g:miniBufExplMapCTabSwitchBufs = 1</div><div class="line">let g:miniBufExplModSelTarget = 1</div><div class="line">&quot; ycm 此处要设置成python版本2.7，不要设置成python3了</div><div class="line">let g:ycm_path_to_python_interpreter=&quot;python&quot;</div><div class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</div><div class="line">&quot;syntax check</div><div class="line">set statusline+=%#warningmsg#</div><div class="line">set statusline+=%&#123;SyntasticStatuslineFlag()&#125;</div><div class="line">set statusline+=%*</div><div class="line">let g:syntastic_always_populate_loc_list = 1</div><div class="line">let g:syntastic_check_on_open = 1</div><div class="line">let g:syntastic_check_on_wq = 0</div><div class="line">let g:syntastic_auto_loc_list = 1</div><div class="line">let g:syntastic_python_checkers=[&apos;flake8&apos;]</div><div class="line">let g:syntastic_python_flake8_args=&apos;--ignore W391,E501 --max-line-length 119&apos;</div><div class="line">let g:syntastic_loc_list_height=3</div><div class="line">let g:syntastic_enable_highlighting=0</div><div class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</div><div class="line">&quot;ctags</div><div class="line">set tags=./tags,tags;</div><div class="line">&quot; Tag list (ctags) </div><div class="line">let Tlist_Ctags_Cmd = &apos;/usr/local/bin/ctags&apos; </div><div class="line">let Tlist_Show_One_File = 1 &quot;不同时显示多个文件的tag，只显示当前文件的 </div><div class="line">let Tlist_File_Fold_Auto_Close = 1</div><div class="line">let Tlist_Exit_OnlyWindow = 1 &quot;如果taglist窗口是最后一个窗口，则退出vim </div><div class="line">let Tlist_Use_Right_Window = 1 &quot;在右侧窗口中显示taglist窗口</div><div class="line">nmap tl :Tlist&lt;cr&gt;</div><div class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</div><div class="line">&quot;so that when you preview the new file takes up 80% and the file explorer the other 20%.</div><div class="line">let g:netrw_winsize=25</div><div class="line">let g:netrw_altv = 2</div><div class="line">let g:netrw_browse_split = 3</div><div class="line">let g:netrw_keepdir = 0</div><div class="line">let NERDTreeWinSize=30</div><div class="line">&quot;let g:nerdtree_tabs_open_on_console_startup=1</div><div class="line">&quot;列出当前目录文件  </div><div class="line">map &lt;F3&gt; :NERDTreeToggle&lt;CR&gt;</div><div class="line">imap &lt;F3&gt; &lt;ESC&gt; :NERDTreeToggle&lt;CR&gt;</div><div class="line">&quot;当打开vim且没有文件时自动打开NERDTree</div><div class="line">autocmd vimenter * if !argc() | NERDTree | endif</div><div class="line">&quot; 只剩 NERDTree时自动关闭</div><div class="line">autocmd bufenter * if (winnr(&quot;$&quot;) == 1 &amp;&amp; exists(&quot;b:NERDTreeType&quot;) &amp;&amp; b:NERDTreeType == &quot;primary&quot;) | q | endif</div><div class="line">&quot; 忽略的文件不加载</div><div class="line">set wildignore+=**/fe-dist/**</div><div class="line">set wildignore+=**/node_modules/**</div><div class="line">set wildignore+=**/log/**</div><div class="line">set wildignore+=**/static/**</div><div class="line">set wildignore+=*.swp,*.zip,*.pyc,.git/</div><div class="line">set path=.,,**</div><div class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</div><div class="line">&quot;Yggdroot/indentLine</div><div class="line">let g:indentLine_char = &apos;┊&apos;</div><div class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</div></pre></td></tr></table></figure>
<h2 id="用-vundle-管理-vim-插件"><a href="#用-vundle-管理-vim-插件" class="headerlink" title="用 vundle 管理 vim 插件"></a>用 vundle 管理 vim 插件</h2><p>其实上面脚本一键执行也挺方便的，此处只是稍微介绍一下 vundle 的用法。</p>
<p>可在 <code>.vimrc</code>  文件中添加配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Bundle &apos;cespare/vim-golang&apos;</div><div class="line">Bundle &apos;taglist.vim&apos;</div><div class="line">Bundle &apos;dhruvasagar/vim-table-mode&apos;</div><div class="line">Bundle &apos;godlygeek/tabular&apos;</div><div class="line">Bundle &apos;derekwyatt/vim-scala&apos;</div><div class="line">Bundle &apos;kien/ctrlp.vim&apos;</div><div class="line">Bundle &apos;Valloric/YouCompleteMe&apos;</div><div class="line">Bundle &apos;Yggdroot/indentLine&apos;</div></pre></td></tr></table></figure>
<p>随便开个窗口，从控制台打开vim，然后执行-&gt; :BundleInstall ，vundle会自动下载声明的插件并安装到 ./vim/bundle 目录里面</p>
<p><strong> 到此，安装结束，可以畅游vim了。 </strong></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/vim-settings/" class="archive-article-date">
  	<time datetime="2016-09-30T07:33:13.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-09-30</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vim/">vim</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-ubuntu-set-language" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/ubuntu-set-language/">ubuntu 解决语言设置错误的问题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在使用 ubuntu 命令行登录的时候，出现：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">perl: warning: Setting locale failed.</div><div class="line">perl: warning: Please check that your locale settings:</div><div class="line">    LANGUAGE = (unset),</div><div class="line">    LC_ALL = (unset),</div><div class="line">    LC_MESSAGES = &quot;zh_CN.UTF-8&quot;,</div><div class="line">    LANG = &quot;zh_CN.UTF-8&quot;</div><div class="line">    are supported and installed on your system.</div><div class="line">perl: warning: Falling back to the standard locale (&quot;C&quot;).</div></pre></td></tr></table></figure>
<p>这样的错误，虽说不影响使用，但是感觉挺烦的说。</p>
<p>那么要如何解决呢，有必要记录下：</p>
<p>安装 <code>localepurge</code> 管理语言文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install localepurge</div></pre></td></tr></table></figure>
<p>选择我们想要的语言，例如 <code>en_US.UTF-8</code> 和 <code>zh_CN.UTF-8</code>。</p>
<p>当然也可以使用以下命令再次进行配置：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo dpkg-reconfigure localepurge</div></pre></td></tr></table></figure>
<p>生成自己想要的语言</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo locale-gen zh_CN.UTF-8 en_US.UTF-8</div></pre></td></tr></table></figure>
<p>打印出当前的配置信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">locale</div></pre></td></tr></table></figure>
<p>到此，搞定！！！</p>
<p>默认情况下终端 ssh 的时候会将本地的 locale 传到服务器中，可以通过命令指定 ssh 服务器的语言：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">LC_ALL=en_US.UTF-8 ssh &lt;host&gt;</div></pre></td></tr></table></figure>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/ubuntu-set-language/" class="archive-article-date">
  	<time datetime="2016-06-28T03:26:05.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-06-28</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-hexo-Jekyll-github" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/hexo-Jekyll-github/">hexo/Jekyll + github搭建自己的博客</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>首先，必须有一个GitHub账号，相信大家都有，没有的话自己去创建吧。</p>
<h3 id="一、GitHub-Pages的使用"><a href="#一、GitHub-Pages的使用" class="headerlink" title="一、GitHub Pages的使用"></a>一、GitHub Pages的使用</h3><h4 id="1-创建一个分支，使用你的GitHub-name"><a href="#1-创建一个分支，使用你的GitHub-name" class="headerlink" title="1. 创建一个分支，使用你的GitHub name"></a>1. 创建一个分支，使用你的GitHub name</h4><p>Head over to GitHub and create a new repository named username.github.io, where username is your username (or organization name) on GitHub.</p>
<p>我的GitHub name是 SkylerHu，以我的名字为例。</p>
<h4 id="2-初始化项目"><a href="#2-初始化项目" class="headerlink" title="2. 初始化项目"></a>2. 初始化项目</h4><p><strong>若是借助Jekyll和hexo的话，只需clone下来即可。</strong></p>
<blockquote>
<p>已下步骤是基于terminal的git命令，若是使用界面工具，自己去<a href="https://pages.github.com/" target="_blank" rel="external">GitHub Pages</a>看</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">~$ git <span class="built_in">clone</span> https://github.com/SkylerHu/SkylerHu.github.io</div><div class="line">~$ <span class="built_in">cd</span> SkylerHu.github.io</div><div class="line">~$ <span class="built_in">echo</span> <span class="string">"Hello World"</span> &gt; index.html</div><div class="line">~$ git add --all</div><div class="line">~$ git commit -m <span class="string">"Initial commit"</span></div><div class="line">~$ git push -u origin master</div></pre></td></tr></table></figure>
<p>也可以在index.html中添加HTML内容，然后在push</p>
<p>一切OK之后，可以访问 <a href="http://SkylerHu.github.io" target="_blank" rel="external">http://SkylerHu.github.io</a>.  可以查看index.html的内容。这个网址就是你的博客网址。</p>
<h3 id="二、使用Jekyll"><a href="#二、使用Jekyll" class="headerlink" title="二、使用Jekyll"></a>二、使用Jekyll</h3><p>上面新建的项目中，Settings中可以看到GitHubPages相关配置，官方推荐使用<a href="http://jekyll.bootcss.com/" target="_blank" rel="external">Jekyll</a><br><img src="http://7xpdkx.com1.z0.glb.clouddn.com/2016/06/27/81479b8884.png" alt="GitHub Pages Settings"></p>
<h4 id="1-初始化"><a href="#1-初始化" class="headerlink" title="1. 初始化"></a>1. 初始化</h4><p>安装需要Ruby环境，没有的话自行安装。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">~$ gem install jekyll</div><div class="line">~$ jekyll new my-awesome-site</div></pre></td></tr></table></figure>
<p>把项目生成的所有文件，全部copy到<code>SkylerHu.github.io</code>目录下.</p>
<h4 id="2-目录结构"><a href="#2-目录结构" class="headerlink" title="2. 目录结构"></a>2. 目录结构</h4><ul>
<li><a href="http://jekyll.bootcss.com/docs/structure/" target="_blank" rel="external">目录结构</a></li>
</ul>
<h4 id="3-本地启动预览"><a href="#3-本地启动预览" class="headerlink" title="3. 本地启动预览"></a>3. 本地启动预览</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">~$ <span class="built_in">cd</span> SkylerHu.github.io</div><div class="line">~/SkylerHu.github.io$ jekyll serve</div></pre></td></tr></table></figure>
<p>直接访问<a href="http://localhost:4000/" target="_blank" rel="external">http://localhost:4000/</a>  就可以看到你的网站了。</p>
<h4 id="4-写文章"><a href="#4-写文章" class="headerlink" title="4. 写文章"></a>4. 写文章</h4><p>在目录<code>/SkylerHu.github.io/_posts/</code>下新建xxxx.md；<br>格式需要按照模板提供的去写； </p>
<h4 id="5-部署"><a href="#5-部署" class="headerlink" title="5. 部署"></a>5. 部署</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">~/SkylerHu.github.io$ git add --all</div><div class="line">~/SkylerHu.github.io$ git push</div></pre></td></tr></table></figure>
<h4 id="6-使用自己的域名"><a href="#6-使用自己的域名" class="headerlink" title="6. 使用自己的域名"></a>6. 使用自己的域名</h4><h5 id="1-添加CNAME文件push到GitHub"><a href="#1-添加CNAME文件push到GitHub" class="headerlink" title="1) 添加CNAME文件push到GitHub"></a>1) 添加CNAME文件push到GitHub</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">~/SkylerHu.github.io$ <span class="built_in">echo</span> <span class="string">"pages.skylerhu.com"</span> &gt; CNAME</div></pre></td></tr></table></figure>
<h5 id="2-域名解析"><a href="#2-域名解析" class="headerlink" title="2) 域名解析"></a>2) 域名解析</h5><p>使pages.skylerhu.com解析到 SkylerHu.github.io<br>注意选择 解析类型是<code>CNAME</code></p>
<h4 id="7-主题"><a href="#7-主题" class="headerlink" title="7. 主题"></a>7. 主题</h4><p>推荐网站：</p>
<ul>
<li><a href="http://jekyllthemes.org/" target="_blank" rel="external">http://jekyllthemes.org/</a></li>
<li><a href="https://jekyllthemes.io/" target="_blank" rel="external">https://jekyllthemes.io/</a></li>
</ul>
<p>可以根据自己的喜好去选择主题，都大同小异。</p>
<h3 id="三、使用hexo"><a href="#三、使用hexo" class="headerlink" title="三、使用hexo"></a>三、使用hexo</h3><p>之所有使用<a href="https://hexo.io/zh-cn/" target="_blank" rel="external">hexo</a>,因为好多网友都说这个比较好，所有研究了一下使用方法。</p>
<p>需要安装<a href="https://nodejs.org/en/" target="_blank" rel="external">Node.js</a></p>
<h4 id="1-安装"><a href="#1-安装" class="headerlink" title="1. 安装"></a>1. 安装</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">~$ sudo npm install -g hexo</div></pre></td></tr></table></figure>
<h4 id="2-初始化"><a href="#2-初始化" class="headerlink" title="2. 初始化"></a>2. 初始化</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">~$ <span class="built_in">cd</span> blog</div><div class="line"><span class="comment"># 初始化</span></div><div class="line">~/blog$ hexo init</div><div class="line"><span class="comment"># 生成静态页面，把markdown转化成html，hexo g 也行</span></div><div class="line">~/blog$ hexo generate</div><div class="line"><span class="comment"># 启动本地服务，hexo s 也行</span></div><div class="line">~/blog$ hexo server</div></pre></td></tr></table></figure>
<p>其他<a href="https://hexo.io/zh-cn/docs/commands.html" target="_blank" rel="external">hexo命令</a></p>
<p>若是之后nodejs升级了，需要执行一下 <code>npm --registry=https://registry.npm.taobao.org install</code><br>或者直接执行 <code>npm install</code>, 有参数的意思是使用淘宝源</p>
<h4 id="3-配置GitHub"><a href="#3-配置GitHub" class="headerlink" title="3. 配置GitHub"></a>3. 配置GitHub</h4><p>编辑blog目录下_config.yml文件，详见<a href="https://hexo.io/zh-cn/docs/configuration.html" target="_blank" rel="external">hexo配置</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">~/blog$ vim _config.yml</div></pre></td></tr></table></figure>
<p>找到<code>deploy</code>配置如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">deploy:</div><div class="line">     type: git</div><div class="line">     repo:https://github.com/SkylerHu/SkylerHu.github.io.git</div><div class="line">     branch:master</div><div class="line">     message: commit的message，默认 Site updated: &#123;&#123; now(&apos;YYYY-MM-DD HH:mm:ss&apos;) &#125;&#125;</div></pre></td></tr></table></figure></p>
<p>保存后执行命令安装插件<a href="https://github.com/hexojs/hexo-deployer-git" target="_blank" rel="external">hexo-deployer-git</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">~/blog$ npm install hexo-deployer-git --save</div></pre></td></tr></table></figure></p>
<h4 id="4-配置RSS"><a href="#4-配置RSS" class="headerlink" title="4. 配置RSS"></a>4. 配置RSS</h4><p>编辑_config.yml配置feed<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">feed:</div><div class="line">  type: atom</div><div class="line">  path: atom.xml</div><div class="line">  limit: 20</div><div class="line">  hub:</div></pre></td></tr></table></figure></p>
<p>安装插件<a href="https://github.com/hexojs/hexo-generator-feed" target="_blank" rel="external">hexo-generator-feed</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">~/blog$ npm install hexo-generator-feed --save</div></pre></td></tr></table></figure>
<h4 id="5-部署GitHub-Pages"><a href="#5-部署GitHub-Pages" class="headerlink" title="5. 部署GitHub Pages"></a>5. 部署GitHub Pages</h4><p>部署之前可以修改_confi.yml中deploy.message作为git commit的message<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 每次修改之后都需要clean和generate</span></div><div class="line">~/blog$ hexo clean</div><div class="line">~/blog$ hexo generate</div><div class="line"><span class="comment"># hexo d 也可以</span></div><div class="line">~/blog$ hexo deploy</div></pre></td></tr></table></figure></p>
<p>会生成一个<code>.deploy_git</code> 文件夹同步到GitHub项目中。</p>
<h4 id="5-主题"><a href="#5-主题" class="headerlink" title="5. 主题"></a>5. 主题</h4><p>推荐网站<a href="https://hexo.io/themes/" target="_blank" rel="external">https://hexo.io/themes/</a><br>我自己使用的是 <a href="https://github.com/litten/hexo-theme-yilia" target="_blank" rel="external">hexo-theme-yilia</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">~$ git <span class="built_in">clone</span> https://github.com/litten/hexo-theme-yilia.git themes/yilia</div></pre></td></tr></table></figure>
<p>修改hexo根目录下的 _config.yml ： theme: yilia</p>
<h4 id="6-使用自己的域名-1"><a href="#6-使用自己的域名-1" class="headerlink" title="6. 使用自己的域名"></a>6. 使用自己的域名</h4><p>同Jekyll一样，也需要修改域名解析，同样也要在GitHub项目下添加CNAME文件。</p>
<blockquote>
<p>注意：</p>
<ul>
<li>不能直接在<code>deploy_git</code>目录下直接添加CNAME文件，每次generate之后会删除</li>
<li>需要添加到<code>source</code>文件夹下<code>echo &quot;pages.skylerhu.com&quot; &gt; source/CNAME</code></li>
</ul>
</blockquote>
<h4 id="7-其他配置"><a href="#7-其他配置" class="headerlink" title="7. 其他配置"></a>7. 其他配置</h4><p>可以在blog/_config.yml配置<a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones" target="_blank" rel="external">语言和时区</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">language: zh-Hans</div><div class="line">timezone: Asia/Shanghai</div></pre></td></tr></table></figure></p>
<p>我的网站还添加了<code>多说评论</code>和<code>百度统计</code>，具体使用详见<a href="http://ijiaober.github.io/categories/hexo/" target="_blank" rel="external">推荐网站</a>。</p>
<h3 id="四、比较"><a href="#四、比较" class="headerlink" title="四、比较"></a>四、比较</h3><table>
<thead>
<tr>
<th></th>
<th>Jekyll</th>
<th>hexo</th>
</tr>
</thead>
<tbody>
<tr>
<td>语言</td>
<td>Ruby</td>
<td>node.js</td>
</tr>
<tr>
<td>效率</td>
<td>So fast</td>
<td>稍慢</td>
</tr>
<tr>
<td>部署</td>
<td>需要多个命令</td>
<td>直接使用git命令</td>
</tr>
</tbody>
</table>
<blockquote>
<p>两个之间都可以互相迁移，看个人操作习惯和爱好吧。</p>
</blockquote>
<h3 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h3><p>升级了Node.js后，发现在项目目录中执行hexo相关命令会报出错误</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[Error: Module version mismatch. Expected 47, got 46.]</div><div class="line">&#123; [Error: Cannot find module &apos;./build/default/DTraceProviderBindings&apos;] code: &apos;MODULE_NOT_FOUND&apos; &#125;</div><div class="line">&#123; [Error: Cannot find module &apos;./build/Debug/DTraceProviderBindings&apos;] code: &apos;MODULE_NOT_FOUND&apos; &#125;</div></pre></td></tr></table></figure>
<p>解决方案如下：</p>
<ul>
<li>执行npm uninstall hexo卸载hexo；</li>
<li>重新安装hexo，npm install -g hexo；</li>
<li>到博客目录执行npm install，hexo clean，hexo generate</li>
</ul>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/hexo-Jekyll-github/" class="archive-article-date">
  	<time datetime="2016-06-27T07:41:41.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-06-27</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/GitHub/">GitHub</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Jekyll/">Jekyll</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hexo/">hexo</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-ownclound-disable-fileicon-on-mac" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/ownclound-disable-fileicon-on-mac/">owncloud在mac finder中没有显示状态icon</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>owncloud客户端在mac上使用，没有显示status icon(文件或者文件夹的同步状态图标)</p>
<h3 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h3><h4 id="1-打开设置"><a href="#1-打开设置" class="headerlink" title="1. 打开设置"></a>1. 打开设置</h4><p><img src="http://7xpdkx.com1.z0.glb.clouddn.com/2016/05/10/91c7781082.png" alt="Pic 01"></p>
<h4 id="2-把勾给选中"><a href="#2-把勾给选中" class="headerlink" title="2. 把勾给选中"></a>2. 把勾给选中</h4><p><img src="http://7xpdkx.com1.z0.glb.clouddn.com/2016/05/10/8003ac235a.png" alt="Pic 02"></p>
<h4 id="3-结果"><a href="#3-结果" class="headerlink" title="3. 结果"></a>3. 结果</h4><p><img src="http://7xpdkx.com1.z0.glb.clouddn.com/2016/05/10/e4a26526ea.png" alt="Pic 03"></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/ownclound-disable-fileicon-on-mac/" class="archive-article-date">
  	<time datetime="2016-06-26T10:58:51.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-06-26</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/owncloud/">owncloud</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  


      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 Skyler Hu
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		root: "/"
	}
</script>

<script src="/./main.js"></script>





<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?a2503cc9e29eba24d28584a7506f1eab";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

    
<div class="tools-col">
  <ul class="btn-wrap">
    
      <li class="chose" data-hook="tools-section-all"><span class="text">全部</span><i class="icon-book"></i></li>
    
    
      <li data-hook="tools-section-tag"><span class="text">标签</span><i class="icon-price-tags"></i></li>
    
    
    
  </ul>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all chose">
    	</section>
    

    
    	<section class="tools-section tools-section-tag">
    			<div class="widget tagcloud" id="js-tagcloud">
    				<a href="/tags/Android/" style="font-size: 20px;">Android</a> <a href="/tags/DataStructure/" style="font-size: 10px;">DataStructure</a> <a href="/tags/GitHub/" style="font-size: 10px;">GitHub</a> <a href="/tags/Java/" style="font-size: 12.5px;">Java</a> <a href="/tags/Jekyll/" style="font-size: 10px;">Jekyll</a> <a href="/tags/Linux/" style="font-size: 17.5px;">Linux</a> <a href="/tags/MQTT/" style="font-size: 12.5px;">MQTT</a> <a href="/tags/NFS/" style="font-size: 10px;">NFS</a> <a href="/tags/Play/" style="font-size: 10px;">Play</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/Redis/" style="font-size: 10px;">Redis</a> <a href="/tags/Sencha/" style="font-size: 15px;">Sencha</a> <a href="/tags/Shadowsocks/" style="font-size: 12.5px;">Shadowsocks</a> <a href="/tags/Shell/" style="font-size: 10px;">Shell</a> <a href="/tags/VPN/" style="font-size: 10px;">VPN</a> <a href="/tags/Web/" style="font-size: 10px;">Web</a> <a href="/tags/fastjson/" style="font-size: 10px;">fastjson</a> <a href="/tags/git/" style="font-size: 12.5px;">git</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/mosquitto/" style="font-size: 12.5px;">mosquitto</a> <a href="/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/tags/owncloud/" style="font-size: 10px;">owncloud</a> <a href="/tags/vim/" style="font-size: 10px;">vim</a>
    			</div>
    	</section>
    

    

    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>